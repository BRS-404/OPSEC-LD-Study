Case Study: Arbitrary File Read on Checkpoint Security Gateway (CVE-2024-24919)

Event ID: 263
Event Time: Jun 06, 2024, 03:12 PM
Rule: SOC287 - Arbitrary File Read on Checkpoint Security Gateway

Playbook Questions & Answers

Do You Need Tier 2 Escalation?	- Yes
Was the Attack Successful?	- Yes
What Is the Direction of Traffic?	- Internet → Company Network
Check If It Is a Planned Test	- Not Planned
What Is The Attack Type?	-   LFI & RFI
Is Traffic Malicious? -	Malicious


Extracted Artifacts

203.160.68.12	Originating from a geographical location with poor reputation, known to host cyber attacks (Hong Kong), Sender IP rep = poor, presence on pbl.spamhaus.org	IP Address
203.160.68.12	Poor Email Reputation as per Cisco Talos	URL Address

Investigation & Reasoning

Request observed as a POST HTTP request attempting path traversal via the aCSHELL endpoint, typical of Local File Inclusion (LFI) attacks.

The request targeted CVE-2024-24919 (Checkpoint Security Gateway arbitrary file read).

Not automatically blocked; potential risk exists if other endpoints were compromised.

External source IP with poor reputation; no evidence of internal compromise yet.

Attack represents an obvious probing attempt, suitable for monitoring but not yet full red alert.

The request clearly shows attempted path traversal, following the CSHELL /clients/MyCRL path structure (common endpoint used for exploitation).

Analyst Note

Marked as True Positive due to malicious POST request exploiting CVE-2024-24919 (LFI path traversal) from an IP with poor reputation and confirmed presence on pbl.spamhaus.org. Request was allowed, posing potential risk to targeted systems. Monitoring recommended for lateral movement or further probing.



In-depth walkthrough and reasoning

1. Initial Alert / Event Identification

Identify Alert triggers (e.g., POST to aCSHELL, targeting /clients/MyCRL.)

Why it matters: 
- highlights suspicious activity and potential LFI.
- no legitimate internal traffic needs to perform path traversal in order to access files as the local machine and whitelisted endpoints are trusted by default.

2. Verify Source & Reputation

Check IP geolocation and ASN.

Look up presence in threat intelligence feeds (Talos, Spamhaus, VirusTotal, AbuseIPDB, Hunter.io (email verification/reputation aggregator) ).

Why: Some IPs look normal but may have poor reputation; multiple angles prevent false negatives.
Note: If an IP has no reputation presence on any known reputation databases, it doesn't automatically mean that said IP is safe/clean, if anything, it raises more potential red flags as strange traffic originating from a 'safe' or 'unknown' location could be an indicator of obfuscation through spoofing or VPN usage.
Note 2: C2 servers and payload hosts are usually separate; treat all unrecognized external traffic as suspicious.

3. Analyze the Request / Payload

Look for path traversal patterns (../..), unusual POST payloads, or suspicious filenames.

Check CVE references and known exploits.

Why: Confirms whether the traffic is truly malicious or just testing harmless endpoints.
Note: Path traversal doesn't always look like this, sometimes it has no wildcards (*) or stand-ins (../..) at all. It could look like a simple path access (e.g, ../docs/html/passwd) or it could look like an encrypted string spread across multiple packages, which then gets put back together on the target machine to form the actual payload.

4. Assess Scope & Risk

Determine direction of traffic (external → internal).
- In this specific instance, the traffic was indeed external, as it came from outside the monitored network, clear indication of probing/vertical movement.
- If it were internal → external then it could've been a clear IOC if the traffic was sent to an unknown, external address (an attacker's command & control/C2).
- If it were internal → internal, and it contains very strange payloads, such as commands to remotely access systems or to download and run files, then it would be a clear indication of lateral movement in execution.

Check if other endpoints were targeted or compromised.

Why: Helps decide escalation (Tier 2 vs monitoring).
- In this case, although the attack was allowed, only logged, it wasn't confirmed whether it had managed to spread to any other machines on the network (lateral movement)
- Since it was unknown whether lateral movement was executed, the threat had to be contained and actively monitored from there on out, which requires Tier 2 escalation.

5. Extract & Document Artifacts

IP addresses, email/URL reputations, suspicious filenames, hashes, CLI commands.

Why: These are building blocks for reports, cross-referencing, and later correlation.
Note: Attacks that succeed are never obvious and you will need to thoroughly check the logs of the compromised machine for anything out of place, unexpected downloads, sketchy files/processes and CLI commands being run from an escalated process (through conhost.exe or powershell.exe)

6. Cross-Reference Intel & CVE Reports

Confirm known exploit patterns (e.g., CVE-2024-24919, previous Check Point advisories).

Why: Supports your analysis and reduces reliance on assumptions.

7. Document Reasoning & Analyst Note

Summarize what happened, your observations, and recommended action.

Why: Makes your decisions transparent and defensible.

8. Monitor / Escalate

Decide on immediate action (containment, monitoring, T2 escalation).

Why: Some attacks are probing attempts; others may require urgent response.


OPSEC Lessons Learned

Zero trust for outside traffic: Treat any traffic that breaks network norms or rules as potentially malicious. Verification is key.

Investigate beyond the surface: Not all exploit attempts are obvious. Data forensics on endpoints can reveal the true scope of activity.

Healthy skepticism: Just because traffic or activity looks safe, don’t assume it is. Always verify before trusting.

Multiple intelligence angles: Correlating reputation, CVE references, and log analysis gives a well-rounded picture for informed decisions.

Monitor even low-impact activity: Lack of immediate damage or spread doesn’t mean an incident is harmless; escalation and monitoring may still be warranted.

Probing attacks are warnings: Seemingly harmless reconnaissance is often the precursor to more serious attacks — treat it seriously.